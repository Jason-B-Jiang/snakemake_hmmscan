#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point(alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 6.88, height = 7.33)
}
################################################################################
# TODO - replace hard-coded arguments w/ variable args
orthogroups <- read_csv('../../data/orthogroups.csv', show_col_types = F)
ortholog_alignments <- read_rds('../../resources/ortholog_alignments.rds')
essential_yeast_genes <- read_lines('../../data/essential_yeast_genes.txt')
out <- '../../results/lengths_vs_percent_identities'
# annotate each species-yeast ortholog pair w/ whether the yeast ortholog is
# essential
#
# calculate percent id for each species-yeast single-copy ortholog pair using
# their alignments
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
median(microsp_orthogroups$percent_id)
median(outgroup_orthogroups$percent_id)
median(rozella_orthogroups$percent_id)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point(alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 6.88, height = 7.33)
}
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
?geom_point
ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point(alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
name = 'All'
ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point(alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 6.88, height = 7.33)
ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point(alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(fill = essential) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(fill = essential) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
colnames(orthogroups)
ggplot(orthogroups, aes(y = percent_id, x = length_ratio,
fill = essential)) +
geom_point() +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential))) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups')) +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 18))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
?geom_rug
# TODO - replace hard-coded arguments w/ variable args
orthogroups <- read_csv('../../data/orthogroups.csv', show_col_types = F)
ortholog_alignments <- read_rds('../../resources/ortholog_alignments.rds')
essential_yeast_genes <- read_lines('../../data/essential_yeast_genes.txt')
out <- '../../results/lengths_vs_percent_identities'
# annotate each species-yeast ortholog pair w/ whether the yeast ortholog is
# essential
#
# calculate percent id for each species-yeast single-copy ortholog pair using
# their alignments
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 6.88, height = 7.33)
}
# TODO - replace hard-coded arguments w/ variable args
orthogroups <- read_csv('../../data/orthogroups.csv', show_col_types = F)
ortholog_alignments <- read_rds('../../resources/ortholog_alignments.rds')
essential_yeast_genes <- read_lines('../../data/essential_yeast_genes.txt')
out <- '../../results/lengths_vs_percent_identities'
# annotate each species-yeast ortholog pair w/ whether the yeast ortholog is
# essential
#
# calculate percent id for each species-yeast single-copy ortholog pair using
# their alignments
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 11, height = 7.33)
}
# TODO - replace hard-coded arguments w/ variable args
orthogroups <- read_csv('../../data/orthogroups.csv', show_col_types = F)
ortholog_alignments <- read_rds('../../resources/ortholog_alignments.rds')
essential_yeast_genes <- read_lines('../../data/essential_yeast_genes.txt')
out <- '../../results/lengths_vs_percent_identities'
# annotate each species-yeast ortholog pair w/ whether the yeast ortholog is
# essential
#
# calculate percent id for each species-yeast single-copy ortholog pair using
# their alignments
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 9.5, height = 7.33)
}
# TODO - replace hard-coded arguments w/ variable args
orthogroups <- read_csv('../../data/orthogroups.csv', show_col_types = F)
ortholog_alignments <- read_rds('../../resources/ortholog_alignments.rds')
essential_yeast_genes <- read_lines('../../data/essential_yeast_genes.txt')
out <- '../../results/lengths_vs_percent_identities'
# annotate each species-yeast ortholog pair w/ whether the yeast ortholog is
# essential
#
# calculate percent id for each species-yeast single-copy ortholog pair using
# their alignments
orthogroups <- orthogroups %>%
mutate(essential = yeast_ortholog %in% essential_yeast_genes) %>%
calculate_ortholog_pids(ortholog_alignments)
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 9, height = 7.33)
}
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.2, aes(colour = factor(essential))) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.5, aes(colour = factor(essential))) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
# split orthogroups dataframe into groups of species
microsp_orthogroups <- filter(orthogroups, is_microsp, species != 'R_allo')
rozella_orthogroups <- filter(orthogroups, species == 'R_allo')
outgroup_orthogroups <- filter(orthogroups, !is_microsp)
# plot ortholog lengths vs percent identities for each group of species
dir.create(out, showWarnings = F)
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
plot_lengths_vs_percent_id <- function(orthogroups, name, out) {
# ---------------------------------------------------------------------------
# Saves a plot of relative ortholog lengths of the species to its yeast
# orthologs, versus the percent identities between the species-yeast
# ortholog pairs.
#
# Arguments:
#   orthogroups: dataframe containing ortholog pair lengths and percent ids
#
#   name: name of the group of species contained in orthogroups dataframe
#
#   out: directory to save the resulting plot in
#
# ---------------------------------------------------------------------------
plot <- ggplot(orthogroups, aes(y = percent_id, x = length_ratio)) +
geom_point(aes(colour = factor(essential)), alpha = 0.5) +
geom_rug(alpha = 0.5, aes(colour = factor(essential))) +
labs(x = 'Length of species ortholog / Length of yeast ortholog',
y = '% Identity (Identical positions / Aligned positions)',
title = str_c(name, '\nn = ', nrow(orthogroups), ' ortholog pairs\n',
length(unique(orthogroups$orthogroup)), ' orthogroups'),
color = 'Essential in yeast?') +
theme_bw() +
theme(axis.title = element_text(color = 'black', size = 18),
axis.text = element_text(size = 18),
title = element_text(color = 'black', size = 18),
legend.text = element_text(size = 14))
ggsave(plot = plot, filename = str_c(out, '/', name, '.svg'),
dpi = 600, units = 'in', width = 9, height = 7.33)
}
plot_lengths_vs_percent_id(microsp_orthogroups, 'Microsporidia', out)
plot_lengths_vs_percent_id(rozella_orthogroups, 'Rozella allomycis', out)
plot_lengths_vs_percent_id(outgroup_orthogroups, 'Outgroup species', out)
